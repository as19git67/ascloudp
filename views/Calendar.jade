extends layout
block content
    if error
        p.text-danger #{error}
    h1
        u #{page.EntityNamePlural}
        if canEdit
            | &nbsp;
            span(class='calendarNew' data-pageid='#{page.Name}') +
    if icalUrl
        div.row
            div(class="col-md-12 col-xs-12")
                a(href="#{icalUrl}") Diesen Kalender als iCal importieren
    if !Records || Records.length == 0
        p.text-info Keine #{page.EntityNamePlural} zum Anzeigen
    if canEdit
        div.row
            div.col-xs-12
                div.h4 Filter:
                    span(class="btn-group filter", data-toggle="buttons")
                        if includeNotPublished
                            label.btn.btn-primary.active
                                input(type="checkbox", id="includeNotPublished", autocomplete="off", checked)
                                | Zukünftige
                         else
                            label.btn.btn-default
                                input(type="checkbox", id="includeNotPublished", autocomplete="off")
                                | Zukünftige
                        if includeOld
                            label.btn.btn-primary.active
                                input(type="checkbox", id="includeOld", autocomplete="off", checked)
                                | Abgelaufene
                        else
                            label.btn.btn-default
                                input(type="checkbox", id="includeOld", autocomplete="off")
                                | Abgelaufene
                        if includeDeleted
                            label.btn.btn-primary.active
                                input(type="checkbox", id="includeDeleted", autocomplete="off", checked)
                                | Gelöschte
                        else
                            label.btn.btn-default
                                input(type="checkbox", id="includeDeleted", autocomplete="off")
                                | Gelöschte

    each record in Records
        div(class="row calendarListItem", data-id='#{record.id}')
            div(class="col-md-12 col-xs-12")
                div.panel.panel-default
                    div.panel-heading #{record.event_start_date_formatted}
                        if canEdit
                            span.glyphicon.glyphicon-edit(data-id='#{record.id}')
                    if record.deletedEvent
                        p.small
                            span.text-warning
                                strong Dieser Eintrag ist gelöscht
                    else
                        if record.pastEvent
                            p.small
                                span.text-info
                                    strong Dieser Eintrag wurde von #{record.publish_start_formatted} bis #{record.publish_end_formatted} veröffentlicht
                        if record.futureEvent
                            p.small
                                span.text-success
                                    strong Dieser Eintrag wird von #{record.publish_start_formatted} bis #{record.publish_end_formatted} veröffentlicht
                    div.panel-body
                        div(class="col-md-1 col-xs-2")
                            blockquote.blockquote-reverse
                                | #{record.event_start_time_formatted}
                                br
                                span.text-muted #{record.event_end_time_formatted}
                        div(class="col-md-11 col-xs-10")
                            | #{record.Title}
                            if record.Description
                                    | :&nbsp #{record.Description}
                            if record.Location
                                br
                                span.text-muted #{record.Location}

    include common-js.jade
    if canEdit
        script(src="/lib/angular-1.3.8/angular.js", type="text/javascript")
        script(src="/lib/angular-1.3.8/i18n/angular-locale_de-de.js", type="text/javascript")
        script(src="/lib/angular-1.3.8/angular-cookies.js", type="text/javascript")
        script(src="/lib/angular-translate/angular-translate.min.js", type="text/javascript")
        script(src="/lib/angular-bootstrap/ui-bootstrap.js", type="text/javascript")
        script(src="/lib/angular-bootstrap/ui-bootstrap-tpls.js", type="text/javascript")
        script(src="/lib/jstz-1.0.4/jstz.min.js", type="text/javascript")
        include CalendarTemplate.html
        script(src="/javascripts/CalendarApp.js", type="text/javascript")
        script(src="/javascripts/filterToQuery.js", type="text/javascript")
